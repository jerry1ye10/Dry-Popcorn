{% extends "base.html" %}

{% block title %}
  Search
{% endblock %}

{% block content %}
<div class="main">
  <h1>Search</h1>
  <br>
  {% set msgs = get_flashed_messages(with_categories=true) %}
  {% for category, each in msgs %}
    <p class="{{category}}">{{each}}<p>
  {% endfor %}
  <form action="/search" method="GET">
    <p class="login-info">Type in a city name or US zipcode to find songs based on the weather!</p>
    <input type="text" name="q">
    <br><br>
    <input type="submit" id="submit" name="submit" value="Search">
  </form>
  <br>
  {% if has_searched %}
    <p><b>Search results:</b> {{city_info.locationName}}, {{city_info.country}} | {{city_info.temp}}Â°F | {{city_info.condition}}</p>
    <div class="container">
      <div class="row">
        {% for song in song_list %}
            <div class="col-sm-12 col-md-6 col-lg-4 col-xl-3">
              <div class="song">
              <a class="song-link" href="{{song.url}}" target="_blank">
                <img class="song-image" width="250px" height="250px"
                src="{{song.image}}" alt="Cover Image">
                <br>
                <span class="song-title">{{song.name}}</span>
                <br>
                <span class="song-artist">{{song.artist}}</span>
              </a>
              <form action="/change_favorite" method="post">
                <input type="hidden" name="song_name" value="{{song.name}}">
                <input type="hidden" name="song_artist" value="{{song.artist}}">
                <input type="hidden" name="song_url" value="{{song.url}}">
                <input type="hidden" name="song_image" value="{{song.image}}">
                <input class="favorite-button" type="submit" name="submit" value="Favorite">
              </form>
              </div>
            </div>
        {% endfor %}
      </div>
    </div>
  {% endif %}
</div>
{% endblock %}
